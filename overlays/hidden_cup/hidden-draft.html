<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Hidden Draft</title>
  <script src="../../js/jquery-2.0.2.min.js" type="text/javascript" charset="utf-8"></script>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js'></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
  <link rel="stylesheet" href="css/hidden-draft.css">

  <script type="text/javascript">
  </script>

</head>

<body onLoad="init()">
  <div id="nameboxtop"></div>
  <div id="nameboxbottom"></div>
  <div id="venueband"></div>


  <div id="pName1"></div> 




  
  <div id="pName2"></div>

  <div id="picksband"></div>
  <div id="venueHolder">
    <div class="pickbox" id="pB1">
      <div id="pick1"></div>
      <p class="doubleText" id="doubleA">Double</p>
    </div>
    <div class="pickbox" id="pB2">
      <div id="pick2"></div>
      <p class="doubleText" id="doubleB">Double</p>
    </div>
    <div class="pickbox" id="pB3">
      <div id="pick3"></div>
      <p class="doubleText" id="doubleC">Double</p>
    </div>
    <div class="pickbox" id="pB4">
      <div id="pick4"></div>
      <p class="doubleText" id="doubleD">Double</p>
    </div>
    <div class="pickbox" id="pB5">
      <div id="pick5"></div>
      <p class="doubleText" id="doubleE">Double</p>
    </div>
    <div class="pickbox" id="pB6">
      <div id="pick6"></div>
      <p class="doubleText" id="doubleF">Double</p>
    </div>
    <div class="pickbox" id="pB7">
      <div id="pick7"></div>
      <p class="doubleText" id="doubleG">Double</p>
    </div>
    <div class="pickbox" id="pB8">
      <div id="pick8"></div>
      <p class="doubleText" id="doubleH">Double</p>
    </div>
    <div class="pickbox" id="pB9">
      <div id="pick9"></div>
      <p class="doubleText" id="doubleI">Double</p>
    </div>
    <div class="pickbox" id="pB10">
      <div id="pick10"></div>
      <p class="doubleText" id="doubleJ">Double</p>
    </div>
  </div>

  <div id="gabriotron">
    <div id="gabriotronbody"></div>
    <div id="gabriotronscreen"></div>
  </div>
  <div id="timer"></div>
  <div id="roundnumber"></div>
  <script>
    var timestampOld;
    var timestamp;
    var pName1;
    var delayer = 0;
    var oldMatch = 5;
    var pvenueA1;
    var matchType;
    var xmlDoc;
    var pvenueA1 = "veranda";


    var animating = false;
    var doUpdate = false;

    $(document).ready(function () {
      bc.postMessage('hello');
    });

    function init() {



      Blank = "blank";

      $('#pName1').html('')
      $('#pName2').html('')
      anime({
        targets: '#nameboxtop',
        top: 0,
        duration: 600,
        delay: 200,
        easing: 'easeOutQuad'

      });

      anime({
        targets: '#nameboxbottom',
        top: 0,
        duration: 600,
        delay: 200,
        easing: 'easeOutQuad'

      });





      anime({
        targets: '#gabriotron',
        top: [
          { value: 200, duration: 600, delay: 1500, easing: 'easeOutQuad' },
          { value: 1500, duration: 900, delay: 9500, easing: 'easeOutQuad' }
        ]


      });

      anime({
        targets: '#picksband',
        left: 0,
        duration: 1000,
        delay: 12000,
        easing: 'easeOutQuad',
        complete: function () {
          delayer = 1;
        }
      });

      anime({
        targets: '#venueHolder',
        left: 0,
        duration: 1000,
        delay: 13000,
        easing: 'easeOutQuad',
        complete: function () {
        }
      });

    }



    const bc = new BroadcastChannel('picks');

    bc.onmessage = function (ev) {
      const received_data = ev.data;
      var { draftVars, doubleChk } = received_data;

      varSplitter = [];
      for (let i = 0; i < draftVars.length; i++) {
        varSplitter = draftVars[i].split(';;');
        window[varSplitter[0]] = varSplitter[1];

      }

      ckbxSplitter = [];
		for (let q = 0; q < doubleChk.length; q++) {
			ckbxSplitter = doubleChk[q].split(';;');
				window[ckbxSplitter[0]] = ckbxSplitter[1];

			
		}

      if ($('#pName1').html() != pName1) {


        anime({
          targets: '#pName1',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'linear',
          complete: function () {
            $('#pName1').html(pName1 + " doesn't like " + ban1);

            anime({
              targets: '#pName1',
              opacity: 1,
              duration: 500,
              delay: 500,
              easing: 'linear',
              complete: function () {

              }

            });
          }

        });

      }


      if ($('#pName2').html() != pName2) {

        anime({
          targets: '#pName2',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'linear',
          complete: function () {
            $('#pName2').html(pName2 + " doesn't like " + ban2);

            anime({
              targets: '#pName2',
              opacity: 1,
              duration: 500,
              delay: 500,
              easing: 'linear',
              complete: function () {

              }

            });
          }

        });

      }

      if (matchType == "1" || matchType == "2") {
        $('#gabriotronbody').css("background-image", "url('images_draft/GT5000.png')");
        $('#gabriotronscreen').css("background-image", "url('images_draft/GT5002.gif')");
      }

      if (matchType == "3" || matchType == "4") {
        $('#gabriotronbody').css("background-image", "url('images_draft/GTC_Body2.png')");
        $('#gabriotronscreen').css("background-image", "url('images_draft/GTC_Screen.gif')");
      }

      if ($('#roundnumber').html() != ("Round " + matchType + " Match")) {


        anime({
          targets: '#roundnumber',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'linear',
          complete: function () {
            $('#roundnumber').html("Round " + matchType + " Match");

            anime({
              targets: '#roundnumber',
              opacity: 1,
              duration: 500,
              delay: 500,
              easing: 'linear',
              complete: function () {

              }

            });
          }

        });

      }

      if ($('#pick1').html() != pick1) {

        anime({
          targets: '#pick1',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick1').css("background-image", "url(images_draft/" + pick1 + ".png)");
            $('#pick1').html(pick1);

            anime({
              targets: '#pick1',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {
                $('#doubleA').css("opacity","1");
              },

            });
          },

        });

      }

      if ($('#pick2').html() != pick2) {

        anime({
          targets: '#pick2',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick2').css("background-image", "url(images_draft/" + pick2 + ".png)");
            $('#pick2').html(pick2);

            anime({
              targets: '#pick2',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick3').html() != pick3) {

        anime({
          targets: '#pick3',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick3').css("background-image", "url(images_draft/" + pick3 + ".png)");
            $('#pick3').html(pick3);

            anime({
              targets: '#pick3',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick4').html() != pick4) {

        anime({
          targets: '#pick4',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick4').css("background-image", "url(images_draft/" + pick4 + ".png)");
            $('#pick4').html(pick4);

            anime({
              targets: '#pick4',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick5').html() != pick5) {

        anime({
          targets: '#pick5',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick5').css("background-image", "url(images_draft/" + pick5 + ".png)");
            $('#pick5').html(pick5);

            anime({
              targets: '#pick5',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick6').html() != pick6) {

        anime({
          targets: '#pick6',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick6').css("background-image", "url(images_draft/" + pick6 + ".png)");
            $('#pick6').html(pick6);

            anime({
              targets: '#pick6',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick7').html() != pick7) {

        anime({
          targets: '#pick7',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick7').css("background-image", "url(images_draft/" + pick7 + ".png)");
            $('#pick7').html(pick7);

            anime({
              targets: '#pick7',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick8').html() != pick8) {

        anime({
          targets: '#pick8',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick8').css("background-image", "url(images_draft/" + pick8 + ".png)");
            $('#pick8').html(pick8);

            anime({
              targets: '#pick8',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick9').html() != pick9) {

        anime({
          targets: '#pick9',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick9').css("background-image", "url(images_draft/" + pick9 + ".png)");
            $('#pick9').html(pick9);

            anime({
              targets: '#pick9',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }

      if ($('#pick10').html() != pick10) {

        anime({
          targets: '#pick10',
          opacity: 0,
          duration: 500,
          delay: 0,
          easing: 'easeOutQuad',
          complete: function () {
            $('#pick10').css("background-image", "url(images_draft/" + pick10 + ".png)");

            anime({
              targets: '#pick10',
              opacity: 1,
              duration: 500,
              delay: 520,
              easing: 'easeOutQuad',
              complete: function () {

              },

            });
          },

        });

      }
      
      setTimeout(() => {
        if (pick1 == "") {
          $('#pB1').css('display','none');
        } else {
          $('#pB1').css('display','block');
        }

        if (doubleA == 'true') {	
          $('#doubleA').css("visibility", "visible");
        }  else if (doubleA == 'false') {
          $('#doubleA').css("visibility", "hidden");
        }

        if (pick2 == "") {
          $('#pB2').css('display','none');
        } else {
          $('#pB2').css('display','block');
        }

        if (doubleB == 'true') {	
          $('#doubleB').css("visibility", "visible");
        }  else if (doubleB == 'false') {
          $('#doubleB').css("visibility", "hidden");
        }

        if (pick3 == "") {
          $('#pB3').css('display','none');
        } else {
          $('#pB3').css('display','block');
        }

        if (doubleC == 'true') {	
          $('#doubleC').css("visibility", "visible");
        }  else if (doubleC == 'false') {
          $('#doubleC').css("visibility", "hidden");
        }

        if (pick4 == "") {
          $('#pB4').css('display','none');
        } else {
          $('#pB4').css('display','block');
        }
        if (doubleD == 'true') {	
          $('#doubleD').css("visibility", "visible");
        }  else if (doubleD == 'false') {
          $('#doubleD').css("visibility", "hidden");
        }

        if (pick5 == "") {
          $('#pB5').css('display','none');
        } else {
          $('#pB5').css('display','block');
        }
        if (doubleE == 'true') {	
          $('#doubleE').css("visibility", "visible");
        }  else if (doubleE == 'false') {
          $('#doubleE').css("visibility", "hidden");
        }

        if (pick6 == "") {
          $('#pB6').css('display','none');
        } else {
          $('#pB6').css('display','block');
        }
        if (doubleF == 'true') {	
          $('#doubleF').css("visibility", "visible");
        }  else if (doubleF == 'false') {
          $('#doubleF').css("visibility", "hidden");
        }

        if (pick7 == "") {
          $('#pB7').css('display','none');
        } else {
          $('#pB7').css('display','block');
        }
        if (doubleG == 'true') {	
          $('#doubleG').css("visibility", "visible");
        }  else if (doubleG == 'false') {
          $('#doubleG').css("visibility", "hidden");
        }

        if (pick8 == "") {
          $('#pB8').css('display','none');
        } else {
          $('#pB8').css('display','block');
        }
        if (doubleH == 'true') {	
          $('#doubleH').css("visibility", "visible");
        }  else if (doubleH == 'false') {
          $('#doubleH').css("visibility", "hidden");
        }

        if (pick9 == "") {
          $('#pB9').css('display','none');
        } else {
          $('#pB9').css('display','block');
        }
        if (doubleI == 'true') {	
          $('#doubleI').css("visibility", "visible");
        }  else if (doubleI == 'false') {
          $('#doubleI').css("visibility", "hidden");
        }

        if (pick10 == "") {
          $('#pB10').css('display','none');
        } else {
          $('#pB10').css('display','block');
        }
        if (doubleJ == 'true') {	
          $('#doubleJ').css("visibility", "visible");
        }  else if (doubleJ == 'false') {
          $('#doubleJ').css("visibility", "hidden");
        }
      }, 600);

      if (oldMatch != $('#roundnumber').html()) {
        oldMatch = $('#roundnumber').html();

      }

    }









  </script>
</body>

</html>